(()=>{document.addEventListener("DOMContentLoaded",function(c){b(),console.log(">"+window.location.host),console.log(">"+window.location.path),htmx.on("htmx:afterSettle",function(i){if(i.target.id==="nav")var g=new Swiper(".swiper",{direction:"horizontal",slidesPerView:"1",spaceBetween:30,centeredSlides:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0},breakpoints:{"@0.00":{slidesPerView:3,spaceBetween:10},"@0.50":{slidesPerView:6,spaceBetween:20},"@1.00":{slidesPerView:9,spaceBetween:40},"@1.50":{slidesPerView:12,spaceBetween:50}}})})});function b(){console.log("Initializing CesiumJS..."),htmx.on("htmx:afterRequest",e=>{if(console.log("Navigate to "+e.detail.pathInfo.requestPath),e.srcElement.dataset&&e.srcElement.dataset.loc){console.log(JSON.parse(e.srcElement.dataset.loc));let t=JSON.parse(e.srcElement.dataset.loc).view;console.log(t),i.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.height),orientation:{heading:Cesium.Math.toRadians(t.heading),pitch:Cesium.Math.toRadians(t.pitch),roll:Cesium.Math.toRadians(t.roll)}})}}),Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2ZjVhODYyOS04NjBlLTQ5MDUtOWI4MC1hMGRiNWUwYTU0NGQiLCJpZCI6NTY2NCwic2NvcGVzIjpbImFzciIsImdjIl0sImlhdCI6MTU0Mzg5MzE5Nn0.5VoO3hPjqXGjUQg0mF8Mt0JyeVwUKqytjrCtLvxGNw0";var c=Cesium.Terrain.fromWorldTerrain();console.log("Create Viewer");let i=new Cesium.Viewer("cesiumContainer",{useBrowserRecommendedResolution:!1,terrain:c,animation:!1,timeline:!1,infoBox:!1,navigationHelpButton:!1,baseLayerPicker:!1,homeButton:!1,sceneModePicker:!1,resolutionScale:1});var g=[{latitude:48.830054,longitude:-123.758148,height:1e3,heading:300,pitch:-45,roll:0},{latitude:48.830054,longitude:-123.758148,height:1e3,heading:300,pitch:-30.5,roll:0},{latitude:48.830054,longitude:-123.758148,height:1e3,heading:300,pitch:-15,roll:0}],s=g[0],C=new Cesium.Cartesian3.fromDegrees(s.longitude,s.latitude,s.height),p={heading:Cesium.Math.toRadians(s.heading),pitch:Cesium.Math.toRadians(s.pitch),roll:Cesium.Math.toRadians(s.roll)};i.camera.setView({destination:C,orientation:p}),Cesium.GeoJsonDataSource.load("/pins/locations.json",{clampToGround:!0}).then(e=>{i.dataSources.add(e);let a=e.entities.values;for(let t=0;t<a.length;t++){let n=a[t],r="";Cesium.defined(n.properties)&&Cesium.defined(n.properties.title)?r=n.properties.title.getValue():r=n.id,n.billboard.image="/images/npsPictograph_0231b.png",n.billboard.scale=.4,n.label={text:r,font:"14pt sans-serif",fillColor:Cesium.Color.YELLOW,outlineColor:Cesium.Color.WHITE,outlineWidth:1,style:Cesium.LabelStyle.FILL_AND_OUTLINE,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-29),disableDepthTestDistance:Number.POSITIVE_INFINITY};let d=15,u=2,o=!0;e.clustering.enabled=o,e.clustering.pixelRange=d,e.clustering.minimumClusterSize=u}});let f=document.getElementById("latitude"),w=document.getElementById("longitude"),v=document.getElementById("altitude"),y=new Cesium.ScreenSpaceEventHandler(i.scene.canvas);i.selectedEntityChanged.addEventListener(function(e){if(Cesium.defined(e))if(Cesium.defined(e.properties)){if(Cesium.defined(e.properties.link)){var a=e.properties.link.getValue()+"summary.txt ",t=new XMLHttpRequest;t.onreadystatechange=function(){this.readyState==4&&this.status==200&&(document.getElementById("htmlSummaryContainer").setHTMLUnsafe(this.responseText),document.getElementById("htmlSummaryContainer").style.display="block",i.flyTo(e))},t.open("GET",a,!0),t.send()}}else console.log("Unknown entity selected."),document.getElementById("htmlSummaryContainer").style.display="none";else document.getElementById("htmlSummaryContainer").style.display="none",console.log("Deselected.")}),y.setInputAction(function(e){var a=i.camera.getPickRay(e.position);if(a){var t=i.scene.globe.pick(a,i.scene);if(Cesium.defined(t)){var n=Cesium.Cartographic.fromCartesian(t),r=Cesium.Math.toDegrees(n.latitude),d=Cesium.Math.toDegrees(n.longitude),u=n.height,o=i.scene.camera,m=o.positionCartographic,l={heading:0,roll:0,pitch:0};l.heading=o.heading,l.pitch=o.pitch,l.roll=o.roll;var I={latitude:Cesium.Math.toDegrees(m.latitude),longitude:Cesium.Math.toDegrees(m.longitude),height:m.height,heading:Cesium.Math.toDegrees(l.heading),pitch:Cesium.Math.toDegrees(l.pitch),roll:Cesium.Math.toDegrees(l.roll)},h={location:{latitude:r,longitude:d,elevation:u},view:I};navigator.clipboard.writeText(JSON.stringify(h));let M=Cesium.Math.toDegrees(n.longitude).toFixed(4),T=Cesium.Math.toDegrees(n.latitude).toFixed(4),S=n.height.toFixed(2);f.textContent=`${T}\xB0`,w.textContent=`${M}\xB0`,v.textContent=`${S} m`,console.log(JSON.stringify(h))}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),i.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(-122.39,47.56,15e5),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:Cesium.Math.toRadians(0)}}),window.addEventListener("resize",()=>{i.container.style.width="100vw",i.container.style.height="100vh",i.resize()})}})();
